<div data-ng-include src="'views/includes/connection.html'"></div>
<section data-ng-controller="AddressController" data-ng-init="findOne()">

    <div id="search-form-mobile" class="visible-xs" data-ng-include src="'views/includes/search.html'"></div>

    <div class="secondary_navbar hidden-xs hidden-sm" scroll data-ng-class="{'hidden': !secondaryNavbar}"
         data-ng-show="address.addrStr" data-ng-init="hideSNavbar=0">
        <div class="container" data-ng-if="!hideSNavbar">
            <div class="col-md-8 text-left">
                <h3 translate>Address</h3> {{address.addrStr}}
                <span class="btn-copy" clip-copy="address.addrStr"></span>
            </div>
            <div class="col-md-4">
                <span class="txvalues txvalues-primary"><strong translate>Final Balance</strong> {{$root.currency.getConvertion(address.available) || address.available + shortName }}</span>
            </div>
        </div>
        <div class="hide_snavbar">
            <a href="#" data-ng-click="hideSNavbar=!hideSNavbar">
                <span data-ng-show="hideSNavbar">
                    <span class="text-muted glyphicon glyphicon-chevron-down"></span>
                </span>
                <span data-ng-show="!hideSNavbar">
                    <span class="text-muted glyphicon glyphicon-chevron-up"></span>
                </span>
            </a>
        </div>
    </div>

    <div class="col-xs-12 col-md-12">
        <div class="page-header form-group">
            <h1><span translate>Address</span>
                <small data-ng-show="address.addrStr">{{ (address.available +" "+ shortName).length > 30 ? (address.available +" "+ shortName).slice(0,30)+ "..." : (address.available +" "+ shortName)}}
                </small>
                <div class="form-horizontal form-group col-md-6 col-xs-12 navbar-right">
                    <label style="font-size: 16px;" class="col-md-4 col-xs-5 control-label" translate>Asset type</label>
                    <div class="col-md-5 col-xs-7">
                        <select data-ng-change="addressGetTxByAssetsId()" data-ng-model="assetsId" class="form-control">
                            <option value="" data-ng-show="loading"></option>
                            <option data-ng-repeat="asset in address.assets" data-ng-selected="' '+asset.shortName == shortName" value="{{asset.assetId}}">{{asset.shortName}}</option>
                        </select>
                    </div>
                </div>
            </h1>
        </div>
    </div>
    <div class="text-muted" data-ng-if="!address.addrStr">
        <span translate>Loading Address Information</span> <span class="loader-gif"></span>
    </div>
    <div data-ng-if="address.addrStr">
        <div class="well well-sm ellipsis">
            <strong translate>Address</strong>
            <span class="text-muted">
                {{address.addrStr}}
                <span style="color: red;" data-ng-show="AddressLabel.hasLabel( address.addrStr )">
                    {{AddressLabel.getLabel( address.addrStr )}}
                </span>
            </span>
            <span class="btn-copy" clip-copy="address.addrStr"></span>
        </div>
        <h2 translate>Summary <small>confirmed</small></h2>
        <div class="row" data-ng-hide="!address.addrStr">
            <div class="col-md-10">
                <table class="table">
                    <tbody>
                    <tr>
                        <td><strong translate>Total Received</strong></td>
                        <td class="ellipsis text-right">{{address.totalReceived + shortName}}
                        </td>
                    </tr>
                    <tr>
                        <td><strong translate>Total Sent</strong></td>
                        <td class="ellipsis text-right">{{address.totalSent + shortName}}
                        </td>
                    </tr>
                    <tr>
                        <td><strong translate>Final Balance</strong></td>
                        <td class="ellipsis text-right">{{address.available + shortName}}
                        </td>
                    </tr>
                    <tr>
                        <td><strong translate>Lock amount</strong></td>
                        <td class="ellipsis text-right">{{address.lock +shortName}}
                        </td>
                    </tr>
                    <tr>
                        <td><strong translate>Available balance</strong></td>
                        <td class="ellipsis text-right">{{address.balance + shortName}}
                        </td>
                    </tr>
                    <tr data-ng-show="address.depositAmount > 0">
                        <td><strong translate>Deposit Amount</strong></td>
                        <td class="ellipsis text-right">{{address.depositAmount + shortName}}
                        </td>
                    </tr>
                    <tr>
                        <td><strong translate>No. Transactions</strong></td>
                        <td class="ellipsis text-right">{{address.txApperances}}</td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="col-md-2 text-center">
                <qrcode size="160" data="{{address.addrStr}}"></qrcode>
            </div>
        </div>
        <div data-ng-show="address.unconfirmedTxApperances">
            <h3 translate>Unconfirmed</h3>
            <table class="table">
                <tbody>
                <tr>
                    <td class="small" translate>Unconfirmed Txs Balance</td>
                    <td class="address ellipsis text-right">
                        {{$root.currency.getConvertion(address.unconfirmedBalance)}}
                    </td>
                </tr>
                <tr>
                    <td class="small" translate>No. Transactions</td>
                    <td class="address ellipsis text-right">{{address.unconfirmedTxApperances}}</td>
                </tr>

                </tbody>
            </table>
        </div>
    </div>
    <div data-ng-if="address.addrStr" data-ng-controller="transactionsController" data-ng-init="load('address',assetId)">
        <h2 translate>Transactions</h2>
        <div id="txMore" data-ng-include src="'views/transaction/list.html'" when-scrolled="loadMore(assetId)"></div>
    </div>
</section>